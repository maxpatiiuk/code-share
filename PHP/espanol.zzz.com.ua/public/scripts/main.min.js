var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var g=a[e];if(b.call(c,g,e,a))return{i:e,v:g}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
var needCaptcha=!0,html_keys="&amp; &#038; &lt; &gt; &quot; &#039;".split(" "),html_values="&&<>\"'".split(""),zoomable=$("#zoomable"),zoomable_used=!1,modal_container=$("#modal"),body=$("body"),modal_edit_obj=null,supports_drag_and_drop=function(){var a=document.createElement("div");return("draggable"in a||"ondragstart"in a&&"ondrop"in a)&&"FormData"in window&&"FileReader"in window}(),is_touch_device=is_touch_device_func(),is_mobile_phone=/Android|webOS|iPhone|iPad|iPod|IEMobile|Opera Mini/i.test(navigator.userAgent);
function htmlspecialchars(a){return a.replace(/[&<>"']/g,function(a){return html_keys[html_values.indexOf(a)]})}function htmlspecialchars_decode(a){return a.replace(/&[\w\d#]{2,5};/g,function(a){return html_values[html_keys.indexOf(a)]})}function preg_match(a,b){return(new RegExp(a)).test(b)}
function checkForCaptcha(a,b){needCaptcha=!1;$.ajax({method:"POST",url:b}).done(function(c){"0"!==c?(needCaptcha=!0,$(a).parent().removeClass("d-none")):needCaptcha=!1}).fail(function(c,b,e){needCaptcha=!0;$(a).parent().removeClass("d-none");mail_error("Unable to check for captcha. Ajax failed",[c,b,e])})}
function forming(a,b,c,d,e,g){g=void 0===g?null:g;var f=void 0===e?null:e;if(null!==f&&null===g)throw alert("CAPCHA_VALIDATION_URL was not specified"),Error("CAPCHA_VALIDATION_URL was not specified");"string"===typeof f&&(f=$(f));setValidator(a,"function"===typeof c?c:function(){var d=new FormData(a.closest("form")[0]);$.ajax({method:"POST",url:b,data:d,cache:!1,contentType:!1,processData:!1}).done(function(b){b=JSON.parse(b);1===b.error?$.each(b,function(b,c){if("error"===b)return!0;"redirect"===
b?window.location.replace(c):"custom"===b?raiseFormError(a,c[1],c[2]):"captcha"===b?(needCaptcha=!0,$(f).parent().removeClass("d-none"),raiseFieldError(f)):raiseFieldError(c[0],c[1],c[2])}):window.location="undefined"!==typeof b.post_id?c+b.post_id:c}).fail(function(a,b,c){alert("\u0412\u0438\u043d\u0438\u043a\u043b\u0430 \u043f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0437\u0431\u0435\u0440\u0456\u0433\u0430\u043d\u0456 \u0437\u043c\u0456\u043d. \u0421\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u0456\u0437\u043d\u0456\u0448\u0435");
mail_error("Unable to save data. Ajax failed",[a,b,c])})},d,f,g)}function setValidator(a,b,c,d,e){d=void 0===d?null:d;e=void 0===e?null:e;if("function"!==typeof b)throw alert("Wrong function"),Error("Wrong function");d instanceof jQuery&&checkForCaptcha(d,e);e=a.closest("form");$(e).on("submit",function(e){new FormData(this);e.preventDefault();validInputs(a,d)?b():"function"===typeof c&&c()})}
function raiseFormError(a,b,c){b=void 0===b?"":b;c=void 0===c?"":c;a=$(a).parent().parent();var d="";0<c.length&&(d=' title="'+c+'"');a.prepend('<div class="alert alert-danger alert-form" '+d+">"+b+"</div>")}
function raiseFieldError(a,b,c){b=void 0===b?"":b;c=void 0===c?"":c;var d="object"!==typeof a?$('[name="'+a+'"]'):a;0===d.length&&(d=$("#a2"+a));1>b.length&&(b=d.attr("data-regex_warning1"));1>c.length&&(c=d.attr("data-regex_warning2"));a="";"undefined"!==typeof c&&0<c.length&&(a=' title="'+c+'"');d.parent().append('<div class="alert alert-danger alert-regex" '+a+">"+b+"</div>")}
function validInputs(a,b){b=void 0===b?null:b;var c=$(a).parent().parent().find("[data-regex]"),d=!0;$(a).parent().parent().find(".alert").remove();b instanceof jQuery&&!0===needCaptcha&&(b.parent().find(".alert").remove(),0===grecaptcha.getResponse().length&&(d=!1,raiseFieldError(b)));c.each(function(){var a=$(this),b=a.attr("data-regex");b=htmlspecialchars_decode(b);var c=a.val();a.parent().find(".alert").remove();preg_match(b,c)||(d=!1,raiseFieldError(a))});return d}
function is_touch_device_func(){try{return document.createEvent("TouchEvent"),!0}catch(a){return!1}}
function modal_edit(a,b){modal_container.html('\n\t\t<div id="modal_edit_obj" class="modal" tabindex="-1" role="dialog">\n\t\t\t<div class="modal-dialog" role="document">\n\t\t\t\t<div class="modal-content">\n\t\t\t\t\t<div class="modal-header">\n\t\t\t\t\t\t<h5 class="modal-title" title="'+text.upload_file[1]+'">'+text.upload_file[0]+'</h5>\n\t\t\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close">\n\t\t\t\t\t\t\t<span aria-hidden="true">&times;</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="modal-body"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\t\n\t');modal_edit_obj=
modal_container.find("#modal_edit_obj");modal_edit_obj.modal("show");modal_container.show();modal_edit_obj.on("hidden.bs.modal",function(){modal_container.hide();modal_container.html("");modal_edit_obj.off("hidden.bs.modal");$(".modal-backdrop.show").remove();body.removeClass("modal-open");modal_edit_obj=null});if("image"===a){modal_container.find(".modal-body").html('\n\t\t\t<form class="box" method="post" enctype="multipart/form-data" action="'+edit_validate_url+'">\n\t\t\t\t<div class="box__input">\n\t\t\t\t\t<input class="box__file" type="file" name="files" id="file">\n\t\t\t\t\t<label for="file">\n\t\t\t\t\t\t<strong title="'+
text.choose_file[1]+'">'+text.choose_file[0]+'</strong>\n\t\t\t\t\t\t<span class="box__dragndrop" title="'+text.or_drag_file[1]+'">'+text.or_drag_file[0]+'</span>.</label>\n\t\t\t\t\t<button class="box__button" type="submit">'+text.upload_file[0]+'</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="box__uploading" title="'+text.file_uploading[1]+'">'+text.file_uploading[0]+'&hellip;</div>\n\t\t\t\t<div class="box__success" title="'+text.file_uploaded[1]+'">'+text.file_uploaded[0]+'!</div>\n\t\t\t\t<div class="box__error" title="'+
text.error_uploading[1]+'">'+text.error_uploading[0]+"! <span></span></div>\n\t\t\t</form>\n\t\t");var c=modal_edit_obj.find(".box"),d=c.find('input[type="file"]'),e=c.find("label"),g=c.find(".box__error span");a=c.find(".box__restart");var f=null,m=function(a){e.append(1<"<br>"+a.length?(d.attr("data-multiple-caption")||"").replace("{count}",a.length):a[0].name+"<br>")};c.append('<input type="hidden" name="type" value="ava" />');d.on("change",function(a){m(a.target.files);c.trigger("submit")});if(supports_drag_and_drop)c.addClass("has-advanced-upload").on("drag dragstart dragend dragover dragenter dragleave drop",
function(a){a.preventDefault();a.stopPropagation()}).on("dragover dragenter",function(){c.addClass("is-dragover")}).on("dragleave dragend drop",function(){c.removeClass("is-dragover")}).on("drop",function(a){f=a.originalEvent.dataTransfer.files;m(f);c.trigger("submit")});c.on("submit",function(a){if(c.hasClass("is-uploading"))return!1;if(!navigator.onLine)return alert(text.no_internet),!1;c.addClass("is-uploading").removeClass("is-error");if(supports_drag_and_drop){a.preventDefault();a=$("input#file").get(0);
0!==a.files.length&&(f=a.files);f=f[0];a=new FormData;a.append("type","ava");a.append("files",f);var d=/(?:\.([^.]+))?$/.exec(f.name)[0];"."!==d[0]&&(d="."+d);if(null==f||null===f.type||"image"!==f.type.substr(0,5))return c.addClass("is-error").removeClass("is-uploading"),f=null,!1;$.ajax({type:"POST",url:c.attr("action"),data:a,dataType:"json",cache:!1,contentType:!1,processData:!1}).always(function(){c.removeClass("is-uploading")}).done(function(a){c.removeClass("is-uploading");0===a.error||"0"===
a.error?(c.addClass("is-success"),modal_edit_obj.trigger("hidden.bs.modal"),$("#"+b).css("background-image","url("+a.src+")")):(c.addClass("is-error"),g.text(a.error1),g.attr("title",a.error2))}).fail(function(a,b,d){alert("Unable to upload photo. Ajax failed");c.addClass("is-error");mail_error("Unable to upload photo. Ajax failed",[a,b,d])})}else{a="uploadiframe"+(new Date).getTime();var l=$('<iframe name="'+a+'" style="display: none;"></iframe>');$("body").append(l);c.attr("target",a);l.one("load",
function(){var a=$.parseJSON(l.contents().find("body").text());c.removeClass("is-uploading").addClass(!0===a.success?"is-success":"is-error").removeAttr("target");a.success||g.text(a.error);l.remove()})}});a.on("click",function(a){a.preventDefault();c.removeClass("is-error is-success");d.trigger("click")});d.on("focus",function(){d.addClass("has-focus")}).on("blur",function(){d.removeClass("has-focus")})}}
function section_edit(a){var b=a.find(".user_profile_edit_field"),c=a.find(".custom-control-input"),d=[],e=new FormData,g=!0;var f=a.is("[data-action]")?a.attr("data-action"):a.parent().attr("data-action");e.append("type","profile_edit");b.each(function(){var a=$(this),b=a.attr("name");var c="_edit"===b.substring(b.length-5)?b.substr(0,b.length-5):b;var h=a.attr("data-regex");h=htmlspecialchars_decode(h);var f=a.val();"user_login_edit"===b&&"@"===f[0]&&(f=f.substring(1));var k=$("#"+c);0===k.length&&
(k=a.parent().find(".section_field_value"));0===k.length&&(k=a.parent().parent().find(".section_field_value"));a.parent().find(".alert").remove();0===f.length&&a.hasClass("user_profile_input_optional")||preg_match(h,f)?!0===g&&(d.push([!0,a,k,f,c]),e.append(b,f)):(g=!1,raiseFieldError(a),e=d=null)});!0===g&&c.each(function(){var a=$(this),b=a.attr("name"),c=a.is(":checked"),h=a.parent().parent();d.push([!1,a,h,c]);e.append(b,c)});if(!navigator.onLine)return alert(text.no_internet),!1;if(!g)return!1;
b="undefined"!==typeof mono_success_function?function(b){if(0===b.error||"0"===b.error){-1!==d[0][4].search("password")&&$.each(d,function(a){d[a][1].val("")});var c=a.find(".user_profile_edit"),n=c.text();c.text(text.saved);setTimeout(function(){c.text(n,"0")},1E3)}else $.each(b,function(a,c){if("error"===a)return!0;"_edit"===a.substring(a.length-5)&&(a=a.substr(0,a.length-5));a=find_with_attr(d,4,a);-1===a&&(alert(text.error_while_saving),mail_error("Ajax returned unknown variables",[d,e,b]));raiseFieldError(d[a][1],
c[1],c[2]);return!1})}:function(b){0===b.error||"0"===b.error?($.each(d,function(a,b){if(b[0]){var c=!1,e=!1;"user_name"===b[4]&&(a=find_with_attr(d,4,a),-1!==a&&(c=!0,0<b[3].length?d[a][2].show():(d[a][2].hide(),b[3]="@"+d[a][3])));"class"===b[4]&&("0"===b[3]&&(b[3]=text.class_undefined[0]),"-1"===b[3]&&(b[3]=text.graduated[0]));"user_login"===b[4]&&(b[3]="@"+b[3]);"email"===b[4]&&(e=!0,b[2].attr("href","mailto:"+b[3]));"phone"===b[4]&&(e=!0,b[2].attr("href","sms:"+b[3]));"birth"===b[4]&&(b[3]=b[3].substr(8,
2)+"."+b[3].substr(5,2)+"."+b[3].substr(0,4));"sm"===b[4].substring(0,2)?(c=$(b[2]).parent(),0===b[3].length?c.hasClass("user_profile_edit_hidden")||c.addClass("user_profile_edit_hidden"):(c.hasClass("user_profile_edit_hidden")&&c.removeClass("user_profile_edit_hidden"),isValidURL(b[3])?b[2].attr("href",b[3]):b[2].attr("href",b[1].attr("data-sm_link")+b[3]))):(e||b[2].text(b[3]),c||(c=b[2].parent(),c.is(".section_field")&&(0===b[3].length?c.addClass("user_profile_edit_hidden"):c.removeClass("user_profile_edit_hidden"))))}else b[3]?
b[2].removeClass("user_profile_edit_hidden"):b[2].addClass("user_profile_edit_hidden")}),a.removeClass("editing")):$.each(b,function(a,c){if("error"===a)return!0;"_edit"===a.substring(a.length-5)&&(a=a.substr(0,a.length-5));a=find_with_attr(d,4,a);-1===a&&(alert(text.error_while_saving),mail_error("Ajax returned unknown variables",[d,e,b]));raiseFieldError(d[a][1],c[1],c[2]);return!1})};$.ajax({type:"POST",url:f,data:e,dataType:"json",cache:!1,contentType:!1,processData:!1}).done(b).fail(function(a,
b,c){alert(text.error_while_saving);mail_error("Unable to save profile data. Ajax failed",[a.responseText,a.readyState,a.status,a.statusText,b,c])})}function mail_error(a,b){$.post(mail_url,{header:a,data:JSON.stringify(b)})}function find_with_attr(a,b,c){for(var d=0;d<a.length;d+=1)if(a[d][b]===c)return d;return-1}is_touch_device&&$("*[title]:not(a):not(button)").click(function(){var a=$(this),b=a.attr("title");a.attr("title",a.text());a.text(b)});
$(".sms_link").click(function(){if(!is_mobile_phone)return alert($(this).attr("href").substr(4)),!1});function isValidURL(a){var b=document.createElement("a");b.href=a;return b.host&&b.host!==window.location.host}$(".zoomable").click(function(){zoomable_click($(this))});
function zoomable_click(a){a=void 0===a?null:a;if(null==a)return!1;var b=a.css("background-image");if(null==b||1>b.length||"none"===b)b=a.attr("src");else if(b=b.substring(4,b.length-1),"'"===b.substring(0,1)||'"'===b.substring(0,1))b=b.substring(1,b.length-1);zoomable_used?(zoomable.show(),zoomable.find("img").attr("src",b)):(zoomable_used=!0,zoomable.html('<img src="'+b+'" alt="zoomable image">'))}zoomable.hide();zoomable.click(function(){$(this).hide()});
$(".user_profile_edit").click(function(){var a=$(this).parent(".section");a.hasClass("editing")||$(this).hasClass("user_profile_mono_edit")?section_edit(a):a.toggleClass("editing")});$.fn.enter_key=function(a,b){return this.each(function(){$(this).keypress(function(c){-1===[13,"13",10,"10"].indexOf(c.keyCode?c.keyCode:c.which)||b&&!c[b+"Key"]||a.call(this,c)})})};
